
      /* 
       * Copyright Â© Monetizer101 - All Rights Reserved
       * Unauthorized copying of this file, via any medium is strictly prohibited.
       * Proprietary and confidential.
       * InText - Library
       * Version: 1.0.0
       * Written by Emilio Venezia <e.venezia@monetizer101.com>, 2019-6-19
       */
      
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.inText=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),c=r(a),u=n(7),s=r(u),l=n(8),d=r(l);n(9).polyfill();t.inText=function(){function e(t){o(this,e),this.selector='[data-type="in-text"]:not([data-checked="true"])',this.nodeList=document.querySelectorAll(this.selector),this.initLoaded=!1;var n={displayWidgets:!0,domain:"//link.monetizer101.com",shopId:1,geolocation:!1,sourcePage:encodeURI(window.location.href),formatDefault:"Buy {product} from {merchant} ({price}), {merchant} ({price}) or {merchant} ({price})",roundPrice:!1,formatCurrency:!1},r=Object.assign(n,t);for(var i in r)r.hasOwnProperty(i)&&(this[i]="domain"===i?r[i].match(/^\/\//)?r[i]:"//"+r[i]:r[i]);(!this.displayWidgets&&document.getElementById("m101WidgetON")||this.displayWidgets&&!document.getElementById("m101WidgetOFF"))&&(this.initLoaded||this.init(0,this.nodeList.length))}return i(e,[{key:"reInit",value:function(){this.initLoaded=!1,this.nodeList=document.querySelectorAll(this.selector),this.init(0,this.nodeList.length)}},{key:"isUPC",value:function(e){return e.match(/^\d{12}$/)}},{key:"isEAN",value:function(e){return e.match(/^\d{13}$/)}},{key:"init",value:function(e,t){var n=this;if(this.initLoaded=!0,void 0===e&&(e=0),e>=t){var r=new MutationObserver(function(e){document.contains(document.querySelector(n.selector))&&(r.disconnect(),n.reInit())});return void r.observe(document,{attributes:!1,childList:!0,characterData:!1,subtree:!0})}var o=this.nodeList[e],i=JSON.parse(o.getAttribute("data-config")),a=this.prices(i.delta,i.price,i.priceMin,i.priceMax),u=o.hasAttribute("data-text"),l=o.hasAttribute("data-exclude"),d=o.hasAttribute("data-url");if(i._isoCurrencyCode=i.isoCurrencyCode?i.isoCurrencyCode:"",i._isoLanguageCode=i.isoLanguageCode?i.isoLanguageCode:"",i.isoCurrencyCode=i.isoCurrencyCode?i.isoCurrencyCode:this.isoCurrencyCode,i.isoLanguageCode=i.isoLanguageCode?i.isoLanguageCode:this.isoLanguageCode,i.groupField="MERCHANT",i.maxProductsPerGroup=1,i.priceType=i.priceType?i.priceType:"SALE_PRICE",i.priceMin=a.priceMin,i.priceMax=a.priceMax,i.sortingField="PRICE",i.sortingOrder="asc",i.nameKeywords=i.nameKeywords?i.nameKeywords.replace(/&/g," "):"",i.nameKeywordsMatchType="EXACT",i.text=u?o.getAttribute("data-text"):this.formatDefault,i.exclude=!!l&&o.getAttribute("data-exclude"),i.url=d?o.getAttribute("data-url"):"",i.barcode=i.barcode?i.barcode:"",i.merchantExclusion=i.merchantExclusion?i.merchantExclusion.toUpperCase():"",this.isUPC(i.nameKeywords)){var f={identifierType:"UPC",identifierValue:""+i.nameKeywords,nameKeywords:""};Object.assign(i,f)}if(this.isEAN(i.nameKeywords)){var p={identifierType:"EAN",identifierValue:""+i.nameKeywords,nameKeywords:""};Object.assign(i,p)}if(o.setAttribute("data-checked",!0),this.geolocation){if(s.default.get("isoCurrencyCode"))i.isoCurrencyCode=s.default.get("isoCurrencyCode"),i.isoLanguageCode=s.default.get("isoLanguageCode"),i._isoCurrencyCode=s.default.get("isoCurrencyCode"),i._isoLanguageCode=s.default.get("isoLanguageCode"),this.search(o,i,e,t);else{var h=this.domain+"/shop-rest/api/int/shop/"+this.shopId+"/market/detect";c.default.get(h).then(function(r){try{i.isoCurrencyCode=r.currencyCode,i.isoLanguageCode=r.languageCode,i._isoCurrencyCode=r.currencyCode,i._isoLanguageCode=r.languageCode,s.default.set("isoCurrencyCode",i.isoCurrencyCode),s.default.set("isoLanguageCode",i.isoLanguageCode),n.search(o,i,e,t)}catch(r){console.log(r),s.default.set("isoCurrencyCode",i.isoCurrencyCode),s.default.set("isoLanguageCode",i.isoLanguageCode),n.search(o,i,e,t)}})}}else this.search(o,i,e,t)}},{key:"fixedEncodeURIComponent",value:function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}},{key:"search",value:function(e,t,n,r){var o=this;if(t.exclude){for(var i=t.exclude.split(","),a="",u=0;u<i.length;u++)a+=" NOT "+i[u];t.nameKeywords=t.nameKeywords+a}delete t.exclude,delete t.formatDefault;var s=this.domain+"/shop-rest/api/int/shop/"+this.shopId+"/widget/text",l=this.domain+"/shop-rest/api/int/shop/"+this.shopId+"/compare/prices/"+(t._isoCurrencyCode||t.isoCurrencyCode)+"_"+(t._isoLanguageCode||t.isoLanguageCode)+"/by/plainlink?url="+(t.url?this.fixedEncodeURIComponent(decodeURIComponent(t.url)):this.fixedEncodeURIComponent(decodeURIComponent(t.nameKeywords.replace(/\\/g,""))))+"&barcode="+t.barcode+"&merchant-exclusion="+t.merchantExclusion;t.url||/^http/.test(t.nameKeywords)?c.default.get(l).then(function(i){try{i.length?(void 0!==o.onFill&&o.onFill(e),o.createText(i,t,function(t){e.innerHTML=t,n++,o.init(n,r)})):(void 0!==o.onEmpty&&o.onEmpty(e),n++,o.init(n,r))}catch(i){console.log(i),void 0!==o.onEmpty&&o.onEmpty(e),console.log("Product not found with these parameters:\n \n          nameKeywords: "+t.nameKeywords+"\n\n          priceMin: "+t.priceMin+"\n\n          priceMax: "+t.priceMax+"\n\n          "),n++,o.init(n,r)}}):c.default.get(s,t).then(function(i){try{i.products.length?(void 0!==o.onFill&&o.onFill(e),o.createText(i.products,t,function(t){e.innerHTML=t,n++,o.init(n,r)})):(void 0!==o.onEmpty&&o.onEmpty(e),n++,o.init(n,r))}catch(i){void 0!==o.onEmpty&&o.onEmpty(e),console.log(i),console.log("Product not found with these parameters:\n \n          nameKeywords: "+t.nameKeywords+"\n\n          priceMin: "+t.priceMin+"\n\n          priceMax: "+t.priceMax+"\n\n          "),n++,o.init(n,r)}})}},{key:"prices",value:function(e,t,n,r){try{if(e&&t){var o=parseInt(e),i=1-o/100,a=1+o/100*3,c=parseFloat(t)*i,u=parseFloat(t)*a;return{priceMin:c.toFixed(2),priceMax:u.toFixed(2)}}return{priceMin:priceMin.toFixed(2),priceMax:priceMax.toFixed(2)}}catch(e){if(this.hasOwnProperty("delta")&&t){var s=parseInt(this.delta),l=1-s/100,d=1+s/100*3,f=parseFloat(t)*l,p=parseFloat(t)*d;return{priceMin:f.toFixed(2),priceMax:p.toFixed(2)}}return{priceMin:void 0===n?"":parseFloat(n).toFixed(2),priceMax:void 0===r?"":parseFloat(r).toFixed(2)}}}},{key:"sign",value:function(e){switch(e){case"GBP":return"&pound;";case"AUD":case"USD":case"CAD":return"$";case"EUR":return"&euro;";case"CHF":return"CHF";case"DKK":return"DKK"}}},{key:"checkUrl",value:function(e){return e=e.replace(/^https?:\/\/link.monetizer101.com/,this.domain),-1!==e.indexOf("?")?e+"&referrer="+this.sourcePage:e+"?referrer="+this.sourcePage}},{key:"createText",value:function(e,t,n){var r=void 0;if(t.text.match(/{product:(.*?)}/)){var o=t.text.match(/{product:(.*?)}/)[0].replace(/{|}/g,"").split(":")[1];r=t.text.replace(/{product:(.*?)}/,'<a href="'+this.checkUrl(e[0].deepLink)+'" target="_blank" rel="nofollow">'+o+"</a>")}else r=t.text.replace("{product}",t.nameKeywords);for(var i=r.split("{merchant}"),a="",c=0;c<i.length;c++)try{c===i.length-1?a+=i[c]:a+=i[c]+'<a href="'+this.checkUrl(e[c].deepLink)+'" target="_blank" rel="nofollow">'+e[c].merchant.name+"</a>"}catch(e){}for(var u=a.split("{price}"),s="",l=0;l<u.length;l++)l===u.length-1?s+=u[l]:t.url?s+=u[l]+'<a href="'+this.checkUrl(e[l].deepLink)+'" target="_blank" rel="nofollow">'+this.sign(t._isoCurrencyCode)+(this.roundPrice?(0,d.default)(e[l].salePrice):e[l].salePrice.toFixed(2))+"</a>":s+=u[l]+'<a href="'+this.checkUrl(e[l].deepLink)+'" target="_blank" rel="nofollow">'+this.sign(t.isoCurrencyCode)+(this.roundPrice?(0,d.default)(e[l].salePrice):e[l].salePrice.toFixed(2))+"</a>";n(s||a)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(i),c=function(){function e(){r(this,e)}return o(e,null,[{key:"Obj",value:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],t=void 0,n=0;n<e.length;n++)try{t=new ActiveXObject(e[n]);break}catch(e){}return t}},{key:"send",value:function(t,n,r,o,i){void 0===i&&(i=!0);var c=function(e){var t=void 0;try{t=JSON.parse(e)}catch(n){t=e}return t};return new a.default(function(a,u){var s=e.Obj();if(s.open(n,t,i),o)for(var l in o)o.hasOwnProperty(l)&&s.setRequestHeader(l,o[l]);s.onload=function(){this.status>=200&&this.status<300?a(c(s.response)):u({status:this.status,statusText:s.statusText})},s.onerror=function(){u({status:this.status,statusText:s.statusText})},s.send(r)})}}]),e}(),u=function(){function e(){r(this,e)}return o(e,null,[{key:"get",value:function(e,t,n,r){var o=[];for(var i in t)o.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return c.send(e+(o.length?"?"+o.join("&"):""),"GET",null,n,r)}},{key:"post",value:function(e,t,n,r){return c.send(e,"POST",JSON.stringify(t),n,r)}},{key:"put",value:function(e,t,n,r,o){var i=[];for(var a in t)i.push(encodeURIComponent(a)+"="+encodeURIComponent(t[a]));return c.send(e+(i.length?"?"+i.join("&"):""),"PUT",void 0===n?null:JSON.stringify(n),r,o)}},{key:"delete",value:function(e,t,n,r){var o=[];for(var i in t)o.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return c.send(e+(o.length?"?"+o.join("&"):""),"DELETE",null,n,r)}}]),e}();t.default=u},function(e,t,n){"use strict";(function(t){function n(){}function r(e,t){return function(){e.apply(t,arguments)}}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function i(e,t){for(;3===e._state;)e=e._value;if(0===e._state)return void e._deferreds.push(t);e._handled=!0,o._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?a:c)(t.promise,e._value);var r;try{r=n(e._value)}catch(e){return void c(t.promise,e)}a(t.promise,r)})}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void u(e);if("function"==typeof n)return void l(r(n,t),e)}e._state=1,e._value=t,u(e)}catch(t){c(e,t)}}function c(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}var d=setTimeout;o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var r=new this.constructor(n);return i(this,new s(e,t,r)),r},o.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},o.all=function(e){return new o(function(t,n){function r(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(t){r(e,t)},n)}o[e]=a,0==--i&&t(o)}catch(e){n(e)}}if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);for(var i=o.length,a=0;a<o.length;a++)r(a,o[a])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},o._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){d(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=o}).call(t,n(3).setImmediate)},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var o=Function.prototype.apply;t.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(4),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return s[u]=r,c(u),u++}function o(e){delete s[e]}function i(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(l)setTimeout(a,0,e);else{var t=s[e];if(t){l=!0;try{i(t)}finally{o(e),l=!1}}}}if(!e.setImmediate){var c,u=1,s={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?function(){c=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),c=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},c=function(t){e.port2.postMessage(t)}}():d&&"onreadystatechange"in d.createElement("script")?function(){var e=d.documentElement;c=function(t){var n=d.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){c=function(e){setTimeout(a,0,e)}}(),f.setImmediate=r,f.clearImmediate=o}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(5),n(6))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(d===clearTimeout)return clearTimeout(e);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){m&&p&&(m=!1,p.length?h=p.concat(h):y=-1,h.length&&c())}function c(){if(!m){var e=o(a);m=!0;for(var t=h.length;t;){for(p=h,h=[];++y<t;)p&&p[y].run();y=-1,t=h.length}p=null,m=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function s(){}var l,d,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}}();var p,h=[],m=!1,y=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||m||o(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=s,f.addListener=s,f.once=s,f.off=s,f.removeListener=s,f.removeAllListeners=s,f.emit=s,f.prependListener=s,f.prependOnceListener=s,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e)}return o(e,null,[{key:"get",value:function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){var o=n[r].trim();if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""}},{key:"set",value:function(e,t){var n=new Date,r=n.getTime();r+=36e5,n.setTime(r),document.cookie=e+"="+t+"; expires="+n.toUTCString()+"; path=/"}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e<0?Math.ceil(e):Math.floor(e)}},function(e,t,n){"use strict";function r(e,t){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(void 0!==o&&null!==o)for(var i=Object.keys(Object(o)),a=0,c=i.length;a<c;a++){var u=i[a],s=Object.getOwnPropertyDescriptor(o,u);void 0!==s&&s.enumerable&&(n[u]=o[u])}}return n}function o(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:r})}e.exports={assign:r,polyfill:o}}])});